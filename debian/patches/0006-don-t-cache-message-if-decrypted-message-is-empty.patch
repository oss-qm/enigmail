From: Patrick Brunschwig <patrick@enigmail.net>
Date: Tue, 3 Apr 2018 06:05:17 +0200
Subject: don't cache message if decrypted message is empty

(cherry picked from commit 80b1884f75df56b7a69777afe50478226e986a6b)
---
 package/pEpDecrypt.jsm | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package/pEpDecrypt.jsm b/package/pEpDecrypt.jsm
index e402408..8755cda 100644
--- a/package/pEpDecrypt.jsm
+++ b/package/pEpDecrypt.jsm
@@ -356,6 +356,7 @@ PEPDecryptor.prototype = {
   isReloadingLastMessage: function() {
     if (!this.uri) return false;
     if (!LAST_MSG.lastMessageURI) return false;
+    if (("lastMessageData" in LAST_MSG) && LAST_MSG.lastMessageData === "") return false;
 
     let currMsg = EnigmailURIs.msgIdentificationFromUrl(this.uri);
 
