From: Patrick Brunschwig <patrick@enigmail.net>
Date: Tue, 3 Apr 2018 06:03:26 +0200
Subject: don't cache message if decrypted message is empty

(cherry picked from commit 26a4c2f7234a64dfd34075b4de1ad2861171537b)
---
 package/mimeDecrypt.jsm | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package/mimeDecrypt.jsm b/package/mimeDecrypt.jsm
index 535de7c..e02750a 100644
--- a/package/mimeDecrypt.jsm
+++ b/package/mimeDecrypt.jsm
@@ -275,6 +275,7 @@ MimeDecryptHandler.prototype = {
   isReloadingLastMessage: function() {
     if (!this.uri) return false;
     if (!LAST_MSG.lastMessageURI) return false;
+    if (("lastMessageData" in LAST_MSG) && LAST_MSG.lastMessageData === "") return false;
 
     let currMsg = EnigmailURIs.msgIdentificationFromUrl(this.uri);
 
