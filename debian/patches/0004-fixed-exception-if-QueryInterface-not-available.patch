From: Patrick Brunschwig <patrick@enigmail.net>
Date: Fri, 2 Mar 2018 11:41:49 +0100
Subject: fixed exception if QueryInterface not available

(cherry picked from commit 9c970ae5cf700e0703c2602bbd6a43d507304a74)
---
 package/msgCompFields.jsm | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/package/msgCompFields.jsm b/package/msgCompFields.jsm
index 37addfb..f77b0c5 100644
--- a/package/msgCompFields.jsm
+++ b/package/msgCompFields.jsm
@@ -143,7 +143,11 @@ var EnigmailMsgCompFields = {
   },
 
   getEnigmailValues: function(enigCompFields) {
-    let cf = enigCompFields.QueryInterface(Ci.nsIMsgSearchValue);
+    let cf = '{}';
+    try {
+      cf = enigCompFields.QueryInterface(Ci.nsIMsgSearchValue);
+    }
+    catch (x) {}
 
     let o = {};
     try {
