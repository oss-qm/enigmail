From: Patrick Brunschwig <patrick@enigmail.net>
Date: Mon, 28 Mar 2016 20:10:20 +0200
Subject: refresh key list after change in key details dialog;
 fixed some wrong method declaration comments

---
 package/windows.jsm              | 14 ++++++++++----
 ui/content/enigmailKeyManager.js |  4 +++-
 2 files changed, 13 insertions(+), 5 deletions(-)

diff --git a/package/windows.jsm b/package/windows.jsm
index 9d03fd7..e46a23e 100644
--- a/package/windows.jsm
+++ b/package/windows.jsm
@@ -296,7 +296,8 @@ const EnigmailWindows = {
    * @win        - |object| holding the parent window for the dialog
    * @userIdArr  - |array| of |strings| containing the User IDs
    * @keyIdArr   - |array| of |strings| containing the key IDs (eg. "0x12345678") to change
-   * no return value
+   *
+   * @return  Boolean - true if expiry date was changed; false otherwise
    */
   editKeyExpiry: function(win, userIdArr, keyIdArr) {
     const inputObj = {
@@ -317,7 +318,8 @@ const EnigmailWindows = {
    * @win        - |object| holding the parent window for the dialog
    * @userIdArr  - |array| of |strings| containing the User IDs
    * @keyIdArr   - |array| of |strings| containing the key IDs (eg. "0x12345678") to change
-   * no return value
+   *
+   * @return  Boolean - true if key trust was changed; false otherwise
    */
   editKeyTrust: function(win, userIdArr, keyIdArr) {
     const inputObj = {
@@ -339,7 +341,8 @@ const EnigmailWindows = {
    * @win        - |object| holding the parent window for the dialog
    * @userId     - |string| containing the User ID (for displaing in the dialog only)
    * @keyId      - |string| containing the key ID (eg. "0x12345678")
-   * no return value
+   *
+   * @return  Boolean - true if key was signed; false otherwise
    */
   signKey: function(win, userId, keyId) {
     const inputObj = {
@@ -412,7 +415,8 @@ const EnigmailWindows = {
    * @keyId      - |string| containing the key ID (eg. "0x12345678")
    * @refresh    - |boolean| if true, cache is cleared and the key data is loaded from GnuPG
    *
-   * no return value
+   * @return  Boolean - true:  keylist needs to be refreshed
+   *                  - false: no need to refresh keylist
    */
   openKeyDetails: function(win, keyId, refresh) {
     const keyListObj = {};
@@ -434,6 +438,8 @@ const EnigmailWindows = {
     if (resultObj.refresh) {
       EnigmailKeyRing.clearCache();
     }
+
+    return resultObj.refresh;
   },
 
   /**
diff --git a/ui/content/enigmailKeyManager.js b/ui/content/enigmailKeyManager.js
index 1f01efa..cbd2091 100644
--- a/ui/content/enigmailKeyManager.js
+++ b/ui/content/enigmailKeyManager.js
@@ -465,7 +465,9 @@ function enigmailSelectAllKeys() {
 function enigmailKeyDetails() {
   var keyList = enigmailGetSelectedKeys();
   if (keyList.length > 0) {
-    EnigmailWindows.openKeyDetails(window, gKeyList[keyList[0]].keyId, false);
+    if (EnigmailWindows.openKeyDetails(window, gKeyList[keyList[0]].keyId, false)) {
+      enigmailRefreshKeys();
+    }
   }
 }
 
